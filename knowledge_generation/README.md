
# Persona Knowledge Generalization

This folder contains the source code of our experiments in **PeaCoK Section 6: Generalizing Persona Knowledge**.
The `baseline` directory contains code modified from the [alexa-with-dstc9-track1-dataset repository](https://github.com/alexa/alexa-with-dstc9-track1-dataset.git).

## Development Environment

- OS: Ubuntu 20.04 LTS (64bit)
- GPU: Nvidia Titan X
- CUDA 11.6
- Python 3.8

## Requirements

```
pip install -r requirements.txt
```

## Model Training

Our preprocessed PeaCoK data for persona knowledge generalization experiments can be downloaded from [this link](https://drive.google.com/file/d/19oapPUb5T-GqcZ0oOpzTTrnzDWyLlB3f/view?usp=sharing), please place `data_persona_gen.zip` under this directory and unzip the file.

For evaluating persona knowledge generalization abilities, we first train two models: 
- a BART-based Comet (Comet-BART) knowledge generator
- a DeBERTa discriminator to re-rank the facts generated by Comet-BART and baseline models (i.e., 5-shot GPT-3 and zero-shot GPT-3.5)

Training Comet-BART with [Kogito](https://github.com/epfl-nlp/kogito) toolkit (with suggested default hyperparameters):

```
python cometbart_training_kogito.py
```

Generate negative data samples for DeBERTa discriminator training:

```
python peacok_data_processing.py
```

Entrypoint for training DeBERTa discriminator (you will find the main training script in `baseline/main.py`):

```
bash deberta_training.sh
```

## Model Inference

To Do: Scripts for persona knowledge generation with Comet-BART and GPT-3/3.5 (+ re-ranking by DeBERTa discriminator).

## Automatic Evaluation

To Do: Automatic evaluation scripts for persona knowledge generation.

## Model Checkpoints

To Do: Google Drive links to our model checkpoints.
